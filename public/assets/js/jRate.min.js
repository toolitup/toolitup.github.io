!function(t){t.fn.jRate=function(o){"use strict";function r(t){return"undefined"!=typeof t}function e(){return r(C)?C.rating:void 0}function n(t){if(!r(t)||t<C.min||t>C.max)throw t+" is not in range("+min+","+max+")";d(t)}function i(t){var o,r='<svg width="'+C.width+'" height='+C.height+' xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"',e=C.horizontal,n='<defs><linearGradient id="grad'+t+'" x1="0%" y1="0%" x2="'+(e?100:0)+'%" y2="'+(e?0:100)+'%"><stop offset="0%"  stop-color='+C.backgroundColor+'/><stop offset="0%" stop-color='+C.backgroundColor+"/></linearGradient></defs>";switch(C.shape){case"STAR":o=r+'viewBox="0 12.705 512 486.59">'+n+'<polygon style="fill: url(#grad'+t+");stroke:"+C.strokeColor+';stroke-width:2px;" points="256.814,12.705 317.205,198.566 512.631,198.566 354.529,313.435 414.918,499.295 256.814,384.427 98.713,499.295 159.102,313.435 1,198.566 196.426,198.566 "/></svg>';break;case"CIRCLE":o=r+">"+n+'<circle  cx="'+C.width/2+'" cy="'+C.height/2+'" r="'+C.width/2+'" fill="url(#grad'+t+')" style="stroke:'+C.strokeColor+';stroke-width:2px;"/></svg>';break;case"RECTANGLE":o=r+">"+n+'<rect width="'+C.width+'" height="'+C.height+'" fill="url(#grad'+t+')" style="stroke:'+C.strokeColor+';stroke-width:2px;"/></svg>';break;case"TRIANGLE":o=r+">"+n+'<polygon points="'+C.width/2+",0 0,"+C.height+" "+C.width+","+C.height+'" fill="url(#grad'+t+')" style="stroke:'+C.strokeColor+';stroke-width:2px;"/></svg>';break;case"RHOMBUS":o=r+">"+n+'<polygon points="'+C.width/2+",0 "+C.width+","+C.height/2+" "+C.width/2+","+C.height+" 0,"+C.height/2+'" fill="url(#grad'+t+')"  style="stroke:'+C.strokeColor+';stroke-width:2px;"/></svg>';break;default:throw Error("No such shape as "+C.shape)}return o}function a(){y.css("white-space","nowrap"),y.css("cursor","pointer"),y.css("fill",C.shape)}function s(t,o){t.on("mousemove",g(o)).on("mouseenter",g(o)).on("click",p(o)).on("mouseover",g(o)).on("hover",g(o)).on("mouseleave",l).on("mouseout",l).on("JRate.change",u).on("JRate.set",w)}function f(){for(var t=0;t<C.count;t++)q.eq(t).find("#grad"+(t+1)).find("stop").eq(0).attr({offset:"0%"}),q.eq(t).find("#grad"+(t+1)).find("stop").eq(0).attr({"stop-color":C.backgroundColor}),q.eq(t).find("#grad"+(t+1)).find("stop").eq(1).attr({offset:"0%"}),q.eq(t).find("#grad"+(t+1)).find("stop").eq(1).attr({"stop-color":C.backgroundColor})}function d(t){f();var o=(C.max-C.min)/C.count;t=(t-C.min)/o;var e=C.startColor;if(C.reverse)for(var n=0;t>n;n++){var i=C.count-1-n;if(q.eq(i).find("#grad"+(i+1)).find("stop").eq(0).attr({offset:"100%"}),q.eq(i).find("#grad"+(i+1)).find("stop").eq(0).attr({"stop-color":e}),parseInt(t)!==t){var a=Math.ceil(C.count-t)-1;q.eq(a).find("#grad"+(a+1)).find("stop").eq(0).attr({offset:100-10*t%10*10+"%"}),q.eq(a).find("#grad"+(a+1)).find("stop").eq(0).attr({"stop-color":C.backgroundColor}),q.eq(a).find("#grad"+(a+1)).find("stop").eq(1).attr({offset:100-10*t%10*10+"%"}),q.eq(a).find("#grad"+(a+1)).find("stop").eq(1).attr({"stop-color":e})}r(k)&&(e=b(C.count-1,n))}else for(var n=0;t>n;n++)q.eq(n).find("#grad"+(n+1)).find("stop").eq(0).attr({offset:"100%"}),q.eq(n).find("#grad"+(n+1)).find("stop").eq(0).attr({"stop-color":e}),10*t%10>0&&(q.eq(Math.ceil(t)-1).find("#grad"+(n+1)).find("stop").eq(0).attr({offset:10*t%10*10+"%"}),q.eq(Math.ceil(t)-1).find("#grad"+(n+1)).find("stop").eq(0).attr({"stop-color":e})),r(k)&&(e=b(C.count,n))}function h(t){var o,r;return o=document.createElement("canvas"),o.height=1,o.width=1,r=o.getContext("2d"),r.fillStyle=t,r.fillRect(0,0,1,1),r.getImageData(0,0,1,1).data}function l(){C.readOnly||(d(C.rating),u(null,{rating:C.rating}))}function c(t,o,r,e){if(!C.readOnly){var n,i=q.eq(o-1);n=C.horizontal?(t.pageX-i.offset().left)/i.width():(t.pageY-i.offset().top)/i.height();var a=(C.max-C.min)/C.count;n=C.reverse?n:1-n;var s=((C.reverse?C.max-C.min-o+1:o)-n)*a;s=C.min+Number(s.toFixed(C.precision)),s<=C.max&&s>=C.min&&(d(s),e&&(C.rating=s),i.trigger(r,{rating:s}))}}function g(t){return function(o){c(o,t,"JRate.change")}}function p(t){return function(o){c(o,t,"JRate.set",!0)}}function u(t,o){C.onChange&&"function"==typeof C.onChange&&C.onChange.apply(this,[o.rating])}function w(t,o){C.onSet&&"function"==typeof C.onSet&&C.onSet.apply(this,[o.rating])}function m(){var t,o,r,e;for(o=0;o<C.count;o++)y.append(i(o+1));for(q=y.find("svg"),o=0;o<C.count;o++)t=q.eq(o),s(t,o+1),C.horizontal?t.css("margin-right",C.shapeGap||"0px"):t.css({display:"block","margin-bottom":C.shapeGap||"0px"}),C.widthGrowth&&(r="scaleX("+(1+C.widthGrowth*o)+")",t.css({transform:r,"-webkit-transform":r,"-moz-transform":r,"-ms-transform":r,"-o-transform":r})),C.heightGrowth&&(e="scaleY("+(1+C.heightGrowth*o)+")",t.css({transform:e,"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e}));f(),d(C.rating),q.attr({width:C.width,height:C.height})}var v,k,q,y=t(this),x={rating:0,shape:"STAR",count:5,width:"20",height:"20",widthGrowth:0,heightGrowth:0,backgroundColor:"white",startColor:"yellow",endColor:"green",strokeColor:"black",shapeGap:"0px",opacity:1,min:0,max:5,precision:1,horizontal:!0,reverse:!1,readOnly:!1,onChange:null,onSet:null},C=t.extend({},x,o),b=function(t,o){for(var r=[],e=0;3>e;e++){var n=Math.round((v[e]-k[e])/t),i=v[e]+n*(o+1);r[e]=i/256?(v[e]-n*(o+1))%256:(v[e]+n*(o+1))%256}return"rgba("+r[0]+","+r[1]+","+r[2]+","+C.opacity+")"};return C.startColor&&(v=h(C.startColor)),C.endColor&&(k=h(C.endColor)),a(),m(),t.extend({},this,{getRating:e,setRating:n,setReadOnly:function(t){C.readOnly=t},isReadOnly:function(){return C.readOnly}})}}(jQuery);